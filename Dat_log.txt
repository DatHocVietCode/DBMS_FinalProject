22/10/2024
- Chỉnh sửa bảng hóa đơn, sửa trạng thái thành nvarchar
- Chỉnh sửa trạng thái hóa đơn để trạng thái mặc định là "Chưa thanh toán"
- Thêm 2 proc:
+ proc_TaoHoaDonMoi
+ proc_ThemChiTietHoaDon 
- Chỉnh sửa giao diện trang bán hàng
- Thêm chức năng add item vào hóa đơn
- Thêm 1 record vào khách hàng:
insert into KhachHang values (0, N'Khách vãng lai', null, null)
- record này dùng chung cho tất cả khách vãng lai
- Chỉnh sửa lại trigger alter TRIGGER trg_CapNhatTongTien, xử lý trường hợp update(mới) và cả insert (cũ)

23/10/2024
- Thêm tính năng cho thanh tìm kiếm (done)
- Sửa hàm lấy dữ liệu trong database getResultFromProc để cho nó trả về cả SQLreader
- Chỉnh sửa proc proc_TimKiemTheoTen để làm việc với view (bỏ)
- Thêm mới proc_TimKiemSanPhamVaDichVu (file word chinhsua23-10)
+ Proc này tích hợp tìm tất cả điều kiện một lần
- Cập nhật description hàm set tổng tiền: Cập nhật, set tổng tiền = value input
- Thêm view DanhSachKhachHang

- Tạo function Tính tổng tiền (1)
- Cập nhật lại trigger trg_CapNhatTongTien trên ChiTietHoaDon, giờ nó sẽ sửa thời gian lập thành datetime.now() => đảm bảo cho trigger mới tạo trên hóa đơn sẽ luôn bắt được sự kiện khi có hàng đươc thêm mới vào hóa đơn. (2)
- tạo trigger trên hóa đơn sau insert, update (3)
- (2) và (3) nhằm mục đích phục vụ cho việc khi thay đổi mã khách hàng trên hóa đơn trigger sẽ auto cập nhật tổng tiền dựa trên điểm tích lũy.
- Lúc trước mình làm thì trigger là trên chitiethoadon => khi thay đổi mã khách hàng trên trigger, nó sẽ không thay đổi điểm tích lũy => không thay đổi giá, mà phải thêm hàng vào thì mới đổi. => lỗi.
=> (2) là cái cớ để trigger bắt được sự kiện khi có hàng thêm mới, hóa đơn sẽ tự động tính lại toàn bộ tổng tiền nhờ (3) gọi tới (1).
- (3) đã được gộp với trigger cũ lúc trước là trigger để ngăn chặn sự thay đổi trạng thái hóa đơn từ đã thanh toán => chưa thanh toán.
Việc gộp để tránh trường hợp cùng tạo 2 trigger trên 1 hành vi update trên bảng.


24/10/2024
- Hoàn thiện việc thêm sản phẩm là thú cưng vào hóa đơn, xem sửa, thanh toán ngay hoặc đẩy hóa đơn vào hàng chờ.
- Thêm records cho bản vật phẩm
- Test và đã chạy được 